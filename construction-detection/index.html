<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>WPIRONMAN | WPIRONMAN</title><meta name="author" content="WP"><meta name="copyright" content="WP"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="工地检测助手                   /* 美化样式 */         .construction-detection-page {             background: linear-gradient(135deg, #f8fbff 0%, #e3f2fd 50%, #f0f8ff 100%);             min-heig">
<meta property="og:type" content="website">
<meta property="og:title" content="WPIRONMAN">
<meta property="og:url" content="https://wp-a.github.io/construction-detection/index.html">
<meta property="og:site_name" content="WPIRONMAN">
<meta property="og:description" content="工地检测助手                   /* 美化样式 */         .construction-detection-page {             background: linear-gradient(135deg, #f8fbff 0%, #e3f2fd 50%, #f0f8ff 100%);             min-heig">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://wpironman.oss-cn-qingdao.aliyuncs.com/head.png">
<meta property="article:published_time" content="2025-09-22T07:03:42.015Z">
<meta property="article:modified_time" content="2025-09-22T07:03:42.015Z">
<meta property="article:author" content="WP">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://wpironman.oss-cn-qingdao.aliyuncs.com/head.png"><link rel="shortcut icon" href="https://wpironman.oss-cn-qingdao.aliyuncs.com/favicon.png"><link rel="canonical" href="https://wp-a.github.io/construction-detection/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"><link rel="preconnect" href="//fonts.googleapis.com" crossorigin=""><link rel="manifest" href="/null"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!true && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Roboto+Slab&amp;display=swap" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"未找到符合您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":true},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: true,
  islazyloadPlugin: false,
  isAnchor: true,
  percent: {
    toc: true,
    rightside: true,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'WPIRONMAN',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'page'
}</script><link rel="stylesheet" href="/css/_custom/category/categories.css"><link rel="stylesheet" href="/css/transpancy.css"><link href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC&amp;family=JetBrains+Mono&amp;display=swap" rel="stylesheet"><link rel="preload" href="https://fonts.googleapis.com/css2?family=Roboto+Slab&amp;display=swap" as="style" crossorigin=""><script>fetch('https://wpironman.top/pv').then(res => res.json()).then(data => {document.getElementById('my-pv').innerText = data.pv;}).catch(() => {document.getElementById('my-pv').innerText = '获取失败';});</script><link rel="preload" href="https://lf6-cdn-tos.bytecdntp.com/cdn/expire-1-M/font-awesome/6.0.0/css/all.min.css" as="style" onload="this.rel='stylesheet'"><!-- 预加载首屏图片 --><link href="https://wpironman.oss-cn-qingdao.aliyuncs.com/1.webp" as="image" crossorigin="anonymous"><meta name="generator" content="Hexo 7.3.0"></head><body><div id="web_bg" style="background-image: url(https://wpironman.oss-cn-qingdao.aliyuncs.com/10year.webp);"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="https://wpironman.oss-cn-qingdao.aliyuncs.com/head.png" onerror="this.onerror=null;this.src='https://wpironman.oss-cn-qingdao.aliyuncs.com/head.gif'" alt="avatar" loading="lazy"></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">29</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">59</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">14</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-book"></i><span> 文章</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></li></ul></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-tools"></i><span> 工具</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/construction-detection/"><i class="fa-fw fas fa-hard-hat"></i><span> 工地检测</span></a></li></ul></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fa-solid fa-user-group"></i><span> 友链</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/link/"><i class="fa-fw fa-solid fa-user-tie"></i><span> 本站友链</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://www.travellings.cn/go.html"><i class="fa-fw fa fa-subway"></i><span> 随机开往</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://travel.moe/go.html?travel=on"><i class="fa-fw fa fa-taxi"></i><span> 异次元之旅</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="page" id="body-wrap"><header class="not-home-page" id="page-header" style="background-image: url(https://wpironman.oss-cn-qingdao.aliyuncs.com/3000.webp);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><img class="site-icon" src="/img/favicon.png" alt="Logo" loading="lazy"><span class="site-name">WPIRONMAN</span></a></span><div id="menus"><div id="search-button"><span class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></span></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-book"></i><span> 文章</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></li></ul></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-tools"></i><span> 工具</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/construction-detection/"><i class="fa-fw fas fa-hard-hat"></i><span> 工地检测</span></a></li></ul></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fa-solid fa-user-group"></i><span> 友链</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/link/"><i class="fa-fw fa-solid fa-user-tie"></i><span> 本站友链</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://www.travellings.cn/go.html"><i class="fa-fw fa fa-subway"></i><span> 随机开往</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://travel.moe/go.html?travel=on"><i class="fa-fw fa fa-taxi"></i><span> 异次元之旅</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="page-site-info"><h1 id="site-title"></h1></div></header><main class="layout" id="content-inner"><div id="page"><div class="container" id="article-container">


    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>工地检测助手</title>
    <link rel="stylesheet" href="/css/construction-detection.css">
    <style>
        /* 美化样式 */
        .construction-detection-page {
            background: linear-gradient(135deg, #f8fbff 0%, #e3f2fd 50%, #f0f8ff 100%);
            min-height: 100vh;
            padding: 20px 0;
            position: relative;
            overflow: hidden;
        }
        
        .construction-detection-page::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="grain" width="100" height="100" patternUnits="userSpaceOnUse"><circle cx="25" cy="25" r="1" fill="rgba(33,150,243,0.08)"/><circle cx="75" cy="75" r="1" fill="rgba(33,150,243,0.06)"/><circle cx="50" cy="10" r="0.5" fill="rgba(33,150,243,0.04)"/><circle cx="10" cy="60" r="0.5" fill="rgba(33,150,243,0.04)"/><circle cx="90" cy="40" r="0.5" fill="rgba(33,150,243,0.04)"/></pattern></defs><rect width="100" height="100" fill="url(%23grain)"/></svg>');
            opacity: 0.4;
            pointer-events: none;
        }
        
        .construction-detection-container {
            max-width: 1000px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 25px;
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.15);
            backdrop-filter: blur(20px);
            padding: 50px;
            position: relative;
            z-index: 1;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .construction-detection-container h1 {
            text-align: center;
            color: #1565c0;
            font-size: 3em;
            margin-bottom: 40px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
            background: linear-gradient(135deg, #1976d2 0%, #1565c0 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            animation: titleGlow 3s ease-in-out infinite alternate;
        }
        
        @keyframes titleGlow {
            0% { filter: drop-shadow(0 0 5px rgba(25, 118, 210, 0.3)); }
            100% { filter: drop-shadow(0 0 15px rgba(25, 118, 210, 0.6)); }
        }
        
        .upload-area {
            background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%);
            border: 3px dashed #1976d2;
            border-radius: 20px;
            padding: 40px 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
            min-height: 200px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            margin-bottom: 20px;
        }
        
        .upload-area::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(25, 118, 210, 0.15), transparent);
            transition: left 0.5s;
        }
        
        .upload-area:hover::before {
            left: 100%;
        }
        
        .upload-area:hover {
            transform: translateY(-5px) scale(1.02);
            box-shadow: 0 20px 40px rgba(25, 118, 210, 0.2);
            background: linear-gradient(135deg, #d1e7dd 0%, #a3d5ff 100%);
        }
        
        .upload-area.dragover {
            background: linear-gradient(135deg, #90caf9 0%, #64b5f6 100%);
            transform: scale(1.05);
            box-shadow: 0 25px 50px rgba(25, 118, 210, 0.3);
        }
        
        .upload-icon {
            font-size: 48px;
            margin-bottom: 15px;
            opacity: 0.8;
        }
        
        .upload-text {
            color: #1565c0;
            font-weight: 500;
        }
        
        .upload-text p {
            margin: 8px 0;
            font-size: 16px;
        }
        
        .upload-hint {
            font-size: 14px !important;
            opacity: 0.7;
            color: #666 !important;
        }
        
        .option-item {
            background: linear-gradient(135deg, #f3f8ff 0%, #e8f4fd 100%);
            border-radius: 20px;
            padding: 20px;
            margin: 15px;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            border: 2px solid #e3f2fd;
            position: relative;
            overflow: hidden;
        }
        
        .option-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.2) 0%, rgba(255, 255, 255, 0.1) 100%);
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        
        .option-item:hover::before {
            opacity: 1;
        }
        
        .option-item:hover {
            transform: translateY(-8px) scale(1.02);
            box-shadow: 0 15px 35px rgba(25, 118, 210, 0.2);
            border-color: #1976d2;
            background: linear-gradient(135deg, #e8f4fd 0%, #d1e7dd 100%);
        }
        
        .option-item input[type="checkbox"]:checked + .option-text {
            color: #1565c0;
            font-weight: bold;
            text-shadow: 0 0 10px rgba(25, 118, 210, 0.3);
        }
        
        .btn {
            background: linear-gradient(135deg, #1976d2 0%, #1565c0 100%);
            border: none;
            border-radius: 50px;
            padding: 15px 35px;
            color: white;
            font-weight: 600;
            font-size: 16px;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 8px 25px rgba(25, 118, 210, 0.4);
            position: relative;
            overflow: hidden;
        }
        
        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.5s;
        }
        
        .btn:hover::before {
            left: 100%;
        }
        
        .btn:hover {
            transform: translateY(-3px) scale(1.05);
            box-shadow: 0 15px 35px rgba(25, 118, 210, 0.6);
        }
        
        .btn:active {
            transform: translateY(-1px) scale(1.02);
        }
        
        .btn:disabled {
            background: linear-gradient(135deg, #bdc3c7 0%, #95a5a6 100%);
            transform: none;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }
        
        .results-section {
            background: linear-gradient(135deg, #42a5f5 0%, #2196f3 100%);
            border-radius: 25px;
            padding: 40px;
            margin-top: 40px;
            color: white;
            position: relative;
            overflow: hidden;
        }
        
        .results-section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="dots" width="20" height="20" patternUnits="userSpaceOnUse"><circle cx="10" cy="10" r="1" fill="rgba(255,255,255,0.1)"/></pattern></defs><rect width="100" height="100" fill="url(%23dots)"/></svg>');
            opacity: 0.3;
        }
        
        .result-section-title {
            color: #fff;
            border-bottom: 3px solid rgba(255, 255, 255, 0.3);
            padding-bottom: 15px;
            margin: 30px 0 20px 0;
            font-size: 1.5em;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
            position: relative;
            z-index: 1;
            text-align: left;
            padding-left: 0;
        }
        
        .result-subsection-title {
            color: #f8f9fa;
            margin: 25px 0 15px 0;
            font-size: 1.2em;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
            position: relative;
            z-index: 1;
            text-align: left;
            padding-left: 0;
        }
        
        .result-list, .result-numbered-list {
            background: rgba(255, 255, 255, 0.2);
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            position: relative;
            z-index: 1;
        }
        
        .result-list-item, .result-numbered-item {
            color: #f8f9fa;
            margin: 12px 0;
            line-height: 1.8;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
        }
        
        .result-paragraph {
            color: #f8f9fa;
            margin: 20px 0;
            line-height: 1.9;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
        }
        
        .custom-prompt-section textarea {
            border-radius: 20px;
            border: 2px solid #e9ecef;
            padding: 20px;
            font-size: 16px;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
        }
        
        .custom-prompt-section textarea:focus {
            border-color: #1976d2;
            box-shadow: 0 0 0 4px rgba(25, 118, 210, 0.2);
            outline: none;
            transform: translateY(-2px);
        }
        
        .image-preview {
            border-radius: 20px;
            overflow: hidden;
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.3);
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .image-preview:hover {
            transform: translateY(-5px) scale(1.02);
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.4);
        }
        
        .image-preview img {
            width: 100%;
            height: auto;
            display: block;
            transition: transform 0.4s ease;
        }
        
        .image-preview:hover img {
            transform: scale(1.05);
        }
        
        .remove-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a24 100%);
            border: none;
            border-radius: 50%;
            padding: 8px;
            color: white;
            font-weight: 600;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 5px 15px rgba(255, 107, 107, 0.4);
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
            line-height: 1;
        }
        
        .remove-btn:hover {
            transform: translateY(-3px) scale(1.05);
            box-shadow: 0 10px 25px rgba(255, 107, 107, 0.6);
        }
        
        .notification {
            border-radius: 20px;
            backdrop-filter: blur(20px);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        }
        
        .error-container {
            background: rgba(255, 255, 255, 0.15);
            border-radius: 20px;
            padding: 40px;
            text-align: center;
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .retry-btn {
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a24 100%);
            border: none;
            border-radius: 25px;
            padding: 15px 30px;
            color: white;
            font-weight: 600;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 8px 25px rgba(255, 107, 107, 0.4);
        }
        
        .retry-btn:hover {
            transform: translateY(-3px) scale(1.05);
            box-shadow: 0 15px 35px rgba(255, 107, 107, 0.6);
        }
        
        /* 加载动画 */
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: #fff;
            animation: spin 1s ease-in-out infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        /* 响应式设计 */
        @media (max-width: 768px) {
            .construction-detection-container {
                margin: 10px;
                padding: 30px 20px;
                border-radius: 20px;
            }
            
            .construction-detection-container h1 {
                font-size: 2.2em;
            }
            
            .options-grid {
                display: grid;
                grid-template-columns: 1fr;
                gap: 10px;
            }
            
            .model-options {
                display: grid;
                grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
                gap: 15px;
                margin: 20px 0;
            }
            
            .model-selection {
                margin-bottom: 30px;
            }
            
            .option-item input[type="radio"] {
                margin-right: 10px;
            }
            
            .option-item small {
                color: #666;
                font-style: italic;
            }
            
            .hazard-categories-display {
                margin-bottom: 30px;
                background: linear-gradient(135deg, #fff8e1 0%, #fffbf0 100%);
                border-radius: 20px;
                padding: 25px;
                border: 2px solid #ffecb3;
            }
            
            .hazard-categories-grid {
                display: grid;
                grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
                gap: 12px;
                margin-top: 20px;
            }
            
            .hazard-category-item {
                background: rgba(255, 255, 255, 0.8);
                padding: 12px 16px;
                border-radius: 12px;
                border-left: 4px solid #ff9800;
                font-size: 14px;
                line-height: 1.4;
                transition: all 0.3s ease;
                cursor: pointer;
            }
            
            .hazard-category-item:hover {
                background: rgba(255, 255, 255, 1);
                transform: translateX(5px);
                box-shadow: 0 4px 12px rgba(255, 152, 0, 0.2);
            }
            
            .hazard-category-item:nth-child(odd) {
                border-left-color: #f44336;
            }
            
            .hazard-category-item:nth-child(even) {
                border-left-color: #2196f3;
            }
            
            .detection-focus {
                margin-bottom: 30px;
                background: linear-gradient(135deg, #f3e5f5 0%, #fce4ec 100%);
                border-radius: 20px;
                padding: 25px;
                border: 2px solid #e1bee7;
            }
            
            .focus-categories-grid {
                display: grid;
                grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
                gap: 15px;
                margin-top: 15px;
            }
            
            .focus-category-item {
                background: rgba(255, 255, 255, 0.9);
                padding: 15px;
                border-radius: 15px;
                border: 2px solid transparent;
                transition: all 0.3s ease;
                cursor: pointer;
                display: flex;
                align-items: center;
                gap: 10px;
            }
            
            .focus-category-item:hover {
                background: rgba(255, 255, 255, 1);
                border-color: #9c27b0;
                transform: translateY(-2px);
                box-shadow: 0 6px 20px rgba(156, 39, 176, 0.2);
            }
            
            .focus-category-item input[type="checkbox"] {
                transform: scale(1.2);
                margin-right: 8px;
            }
            
            .focus-text {
                font-weight: 500;
                color: #4a148c;
            }
            
            .hazard-selection {
                margin-bottom: 30px;
                background: linear-gradient(135deg, #f0f8ff 0%, #e6f3ff 100%);
                border-radius: 20px;
                padding: 25px;
                border: 2px solid #b3d9ff;
            }
            
            .hazard-selection-grid {
                display: grid;
                grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
                gap: 12px;
                margin: 20px 0;
                max-height: 400px;
                overflow-y: auto;
                padding-right: 10px;
            }
            
            .hazard-selection-item {
                background: rgba(255, 255, 255, 0.9);
                padding: 12px 15px;
                border-radius: 12px;
                border: 2px solid transparent;
                transition: all 0.3s ease;
                cursor: pointer;
                display: flex;
                align-items: flex-start;
                gap: 10px;
                font-size: 14px;
                line-height: 1.4;
            }
            
            .hazard-selection-item:hover {
                background: rgba(255, 255, 255, 1);
                border-color: #1976d2;
                transform: translateX(3px);
                box-shadow: 0 4px 12px rgba(25, 118, 210, 0.15);
            }
            
            .hazard-selection-item input[type="checkbox"] {
                margin-top: 2px;
                transform: scale(1.1);
                flex-shrink: 0;
            }
            
            .hazard-text {
                color: #2c3e50;
                font-weight: 500;
            }
            
            .selection-actions {
                display: flex;
                gap: 10px;
                justify-content: center;
                margin-top: 20px;
            }
            
            .btn-secondary {
                background: linear-gradient(135deg, #6c757d 0%, #5a6268 100%);
                color: white;
                border: none;
                border-radius: 25px;
                padding: 8px 20px;
                font-size: 14px;
                cursor: pointer;
                transition: all 0.3s ease;
            }
            
            .btn-secondary:hover {
                transform: translateY(-2px);
                box-shadow: 0 5px 15px rgba(108, 117, 125, 0.4);
            }
            
            .btn {
                padding: 12px 25px;
                font-size: 14px;
            }
        }
        
        /* 滚动条美化 */
        ::-webkit-scrollbar {
            width: 8px;
        }
        
        ::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 10px;
        }
        
        ::-webkit-scrollbar-thumb {
            background: linear-gradient(135deg, #1976d2 0%, #1565c0 100%);
            border-radius: 10px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: linear-gradient(135deg, #1565c0 0%, #0d47a1 100%);
        }
    </style>


    <div class="construction-detection-page">
        <div class="construction-detection-container">
            <h1>🏗️ 工地检测助手</h1>
            
            
            
            <p>欢迎使用基于<strong>大语言模型</strong>驱动的专业工地隐患检测系统！通过上传施工现场图片，系统将：</p>
            
            <ul>
                <li><strong>🔍 隐患识别</strong>：精准识别安全隐患类别和违规行为</li>
                <li><strong>📋 风险评估</strong>：专业的风险等级分析和影响评估</li>
                <li><strong>💡 整改建议</strong>：提供具体可执行的整改措施和预防方案</li>
                <li><strong>📚 合规检查</strong>：对照国家标准和法规要求进行合规性分析</li>
                <li><strong>⚡ 智能分析</strong>：基于先进AI技术的深度图像理解</li>
            </ul>

            <hr>

            <h2>📸 上传检测图片</h2>

            <div class="upload-section">
                <div class="upload-area" id="uploadArea">
                    <div class="upload-icon">📷</div>
                    <div class="upload-text">
                        <p>点击或拖拽上传工地图片</p>
                        <p class="upload-hint">支持 JPG、PNG、WEBP 格式，最大 10MB</p>
                    </div>
                    <input type="file" id="imageInput" accept="image/*" style="display: none;">
                </div>
                
                <div class="image-preview" id="imagePreview" style="display: none;">
                    <img id="previewImg" alt="预览图片" loading="lazy">
                    <button class="remove-btn" id="removeBtn">移除</button>
                </div>
            </div>

            <div class="hazard-categories-display">
                <h3>📋 专业隐患类别参考</h3>
                <div class="hazard-categories-grid">
                    <div class="hazard-category-item">1. 未按规定穿戴反光安全服</div>
                    <div class="hazard-category-item">2. 高处作业未正确使用安全带</div>
                    <div class="hazard-category-item">3. 配电箱未及时锁闭</div>
                    <div class="hazard-category-item">4. 未按规定配置灭火器、消防设施等</div>
                    <div class="hazard-category-item">5. 现场防护栏等安全防护设施缺失、破损或设置不规范</div>
                    <div class="hazard-category-item">6. 设备安全防护设施、装置缺失或失效</div>
                    <div class="hazard-category-item">7. 起重吊装设备钢丝绳磨损、断丝严重，搭接长度不足</div>
                    <div class="hazard-category-item">8. 汽车吊、随车吊、泵车支腿未全部伸出、未垫枕木进行作业</div>
                    <div class="hazard-category-item">9. 基坑支护措施不到位</div>
                    <div class="hazard-category-item">10. 灭火器未按规定要求放置</div>
                    <div class="hazard-category-item">11. 未按规定设置接地线或接地不良</div>
                    <div class="hazard-category-item">12. 安全警示标志标识缺失或设置不规范</div>
                    <div class="hazard-category-item">13. 灭火器压力不足，灭火器、消防设施等未按规定进行检查、维护</div>
                    <div class="hazard-category-item">14. 不符合"三级配电两级漏电保护、一机一闸一漏一箱"要求</div>
                    <div class="hazard-category-item">15. 电缆外皮破损或敷设不规范</div>
                </div>
            </div>

            <div class="model-selection">
                <h3>🤖 选择AI模型</h3>
                <div class="model-options">
                    <label class="option-item">
                        <input type="radio" name="aiModel" value="gemini-1.5-flash" checked="">
                        <span class="option-text">
                            <strong>Gemini 1.5 Flash</strong><br>
                            <small>快速响应，适合日常检测</small>
                        </span>
                    </label>
                    <label class="option-item">
                        <input type="radio" name="aiModel" value="gemini-1.5-pro">
                        <span class="option-text">
                            <strong>Gemini 1.5 Pro</strong><br>
                            <small>高精度分析，适合专业评估</small>
                        </span>
                    </label>
                </div>
            </div>

            <div class="detection-focus">
                <h3>🎯 重点检测隐患类别（可选）</h3>
                <p style="font-size: 14px; color: #666; margin-bottom: 15px;">选择您特别关注的隐患类别，AI将重点分析这些方面：</p>
                <div class="focus-categories-grid">
                    <label class="focus-category-item">
                        <input type="checkbox" value="1,2">
                        <span class="focus-text">👷‍♂️ 人员防护类 (1,2)</span>
                    </label>
                    <label class="focus-category-item">
                        <input type="checkbox" value="3,11,14,15">
                        <span class="focus-text">⚡ 用电安全类 (3,11,14,15)</span>
                    </label>
                    <label class="focus-category-item">
                        <input type="checkbox" value="4,10,13">
                        <span class="focus-text">🔥 消防安全类 (4,10,13)</span>
                    </label>
                    <label class="focus-category-item">
                        <input type="checkbox" value="5,6,9,12">
                        <span class="focus-text">🛡️ 防护设施类 (5,6,9,12)</span>
                    </label>
                    <label class="focus-category-item">
                        <input type="checkbox" value="7,8">
                        <span class="focus-text">🏗️ 机械设备类 (7,8)</span>
                    </label>
                </div>
            </div>

            <div class="hazard-selection">
                <h3>🎯 选择要检测的隐患类别</h3>
                <p style="font-size: 14px; color: #666; margin-bottom: 15px;">请选择您希望重点检测的隐患类别（可多选）：</p>
                <div class="hazard-selection-grid">
                    <label class="hazard-selection-item">
                        <input type="checkbox" value="1" checked="">
                        <span class="hazard-text">1. 未按规定穿戴反光安全服</span>
                    </label>
                    <label class="hazard-selection-item">
                        <input type="checkbox" value="2" checked="">
                        <span class="hazard-text">2. 高处作业未正确使用安全带</span>
                    </label>
                    <label class="hazard-selection-item">
                        <input type="checkbox" value="3" checked="">
                        <span class="hazard-text">3. 配电箱未及时锁闭</span>
                    </label>
                    <label class="hazard-selection-item">
                        <input type="checkbox" value="4" checked="">
                        <span class="hazard-text">4. 未按规定配置灭火器、消防设施等</span>
                    </label>
                    <label class="hazard-selection-item">
                        <input type="checkbox" value="5" checked="">
                        <span class="hazard-text">5. 现场防护栏等安全防护设施缺失、破损或设置不规范</span>
                    </label>
                    <label class="hazard-selection-item">
                        <input type="checkbox" value="6" checked="">
                        <span class="hazard-text">6. 设备安全防护设施、装置缺失或失效</span>
                    </label>
                    <label class="hazard-selection-item">
                        <input type="checkbox" value="7" checked="">
                        <span class="hazard-text">7. 起重吊装设备钢丝绳磨损、断丝严重，搭接长度不足</span>
                    </label>
                    <label class="hazard-selection-item">
                        <input type="checkbox" value="8" checked="">
                        <span class="hazard-text">8. 汽车吊、随车吊、泵车支腿未全部伸出、未垫枕木进行作业</span>
                    </label>
                    <label class="hazard-selection-item">
                        <input type="checkbox" value="9" checked="">
                        <span class="hazard-text">9. 基坑支护措施不到位</span>
                    </label>
                    <label class="hazard-selection-item">
                        <input type="checkbox" value="10" checked="">
                        <span class="hazard-text">10. 灭火器未按规定要求放置</span>
                    </label>
                    <label class="hazard-selection-item">
                        <input type="checkbox" value="11" checked="">
                        <span class="hazard-text">11. 未按规定设置接地线或接地不良</span>
                    </label>
                    <label class="hazard-selection-item">
                        <input type="checkbox" value="12" checked="">
                        <span class="hazard-text">12. 安全警示标志标识缺失或设置不规范</span>
                    </label>
                    <label class="hazard-selection-item">
                        <input type="checkbox" value="13" checked="">
                        <span class="hazard-text">13. 灭火器压力不足，灭火器、消防设施等未按规定进行检查、维护</span>
                    </label>
                    <label class="hazard-selection-item">
                        <input type="checkbox" value="14" checked="">
                        <span class="hazard-text">14. 不符合"三级配电两级漏电保护、一机一闸一漏一箱"要求</span>
                    </label>
                    <label class="hazard-selection-item">
                        <input type="checkbox" value="15" checked="">
                        <span class="hazard-text">15. 电缆外皮破损或敷设不规范</span>
                    </label>
                </div>
                <div class="selection-actions">
                    <button type="button" class="btn-secondary" onclick="window.constructionDetector.selectAllHazards()">全选</button>
                    <button type="button" class="btn-secondary" onclick="window.constructionDetector.clearAllHazards()">清空</button>
                </div>
            </div>

            <div class="custom-prompt-section">
                <h3>✏️ 自定义检测要求</h3>
                <textarea id="customPrompt" placeholder="请输入您特别关注的检测要求（可选）..."></textarea>
            </div>

            <div class="action-buttons">
                <button id="detectBtn" class="btn btn-primary" disabled="">
                    <span class="btn-text">开始检测</span>
                    <span class="btn-loading" style="display: none;">检测中...</span>
                </button>
                <button id="clearBtn" class="btn btn-secondary">清空重来</button>
            </div>

            <div id="resultsSection" class="results-section" style="display: none;">
                <h3>检测结果</h3>
                <div class="result-info">
                    <div id="detectionTime"></div>
                    <div id="imageInfo"></div>
                </div>
                <div id="resultsContent" class="results-content"></div>
                <div class="result-actions">
                    <button id="downloadBtn" class="btn btn-success">下载报告</button>
                    <button id="shareBtn" class="btn btn-info">分享结果</button>
                </div>
            </div>
        </div>
    </div>

    <script src="/js/gemini-direct-client.js"></script>
    <script>
        // 工地检测助手 - 简化版本
        class ConstructionDetectionSimple {
            constructor() {
                this.directClient = new GeminiDirectClient();
                this.directClient.setApiKey('AIzaSyAc9Rl40qShC4PNHmkso5x5gqZXqMbA6Fc');
                this.state = {
                    currentImage: null,
                    isDetecting: false,
                    lastResults: null
                };
                
                this.init();
            }

            init() {
                console.log('工地检测助手初始化中...');
                try {
                    this.setupEventListeners();
                    this.setupDragDropZone();
                    this.loadUserPreferences();
                    console.log('初始化完成');
                } catch (error) {
                    console.error('初始化失败:', error);
                    this.showNotification('系统初始化失败，请刷新页面重试', 'error');
                }
            }

            setupEventListeners() {
                // 获取所有必需的DOM元素
                this.elements = {
                    uploadArea: document.getElementById('uploadArea'),
                    imageInput: document.getElementById('imageInput'),
                    imagePreview: document.getElementById('imagePreview'),
                    previewImg: document.getElementById('previewImg'),
                    removeBtn: document.getElementById('removeBtn'),
                    detectBtn: document.getElementById('detectBtn'),
                    clearBtn: document.getElementById('clearBtn'),
                    customPrompt: document.getElementById('customPrompt'),
                    resultsSection: document.getElementById('resultsSection'),
                    resultsContent: document.getElementById('resultsContent'),
                    detectionTime: document.getElementById('detectionTime'),
                    imageInfo: document.getElementById('imageInfo'),
                    downloadBtn: document.getElementById('downloadBtn'),
                    shareBtn: document.getElementById('shareBtn')
                };

                // 检查关键元素是否存在
                const requiredElements = ['uploadArea', 'imageInput', 'detectBtn'];
                const missingElements = requiredElements.filter(id => !this.elements[id]);
                
                if (missingElements.length > 0) {
                    console.error('缺少必需的DOM元素:', missingElements);
                    this.showNotification(`页面元素加载失败: ${missingElements.join(', ')}`, 'error');
                    return;
                }
                
                console.log('DOM元素检查通过，设置事件监听器...');


                // 上传区域点击事件 - 使用更直接的方式
                if (this.elements.uploadArea && this.elements.imageInput) {
                    this.elements.uploadArea.addEventListener('click', (e) => {
                        e.preventDefault();
                        e.stopPropagation();
                        console.log('上传区域被点击');
                        try {
                            this.elements.imageInput.click();
                            console.log('触发文件选择器');
                        } catch (error) {
                            console.error('触发文件选择器失败:', error);
                            this.showNotification('无法打开文件选择器', 'error');
                        }
                    });
                    console.log('上传区域点击事件已绑定');
                } else {
                    console.error('上传相关元素缺失:', {
                        uploadArea: !!this.elements.uploadArea,
                        imageInput: !!this.elements.imageInput
                    });
                }

                // 文件选择事件
                this.elements.imageInput.addEventListener('change', (e) => {
                    console.log('文件选择事件触发', e.target.files);
                    if (e.target.files && e.target.files.length > 0) {
                        this.handleFileSelect(e.target.files[0]);
                    } else {
                        console.log('未选择文件或文件列表为空');
                    }
                });

                this.elements.removeBtn?.addEventListener('click', () => {
                    this.removeImage();
                });

                this.elements.detectBtn.addEventListener('click', () => {
                    this.startDetection();
                });

                this.elements.clearBtn?.addEventListener('click', () => {
                    this.clearAll();
                });

                this.elements.downloadBtn?.addEventListener('click', () => {
                    this.downloadReport();
                });

                this.elements.shareBtn?.addEventListener('click', () => {
                    this.shareResults();
                });

                // 隐患类别选择事件监听
                const hazardCheckboxes = document.querySelectorAll('.hazard-selection-item input[type="checkbox"]');
                hazardCheckboxes.forEach(checkbox => {
                    checkbox.addEventListener('change', () => {
                        this.updateDetectButton();
                    });
                });
                console.log(`已绑定${hazardCheckboxes.length}个隐患类别选择事件`);
            }

            setupDragDropZone() {
                const uploadArea = this.elements.uploadArea;
                if (!uploadArea) return;

                ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
                    uploadArea.addEventListener(eventName, (e) => {
                        e.preventDefault();
                        e.stopPropagation();
                    });
                });

                ['dragenter', 'dragover'].forEach(eventName => {
                    uploadArea.addEventListener(eventName, () => {
                        uploadArea.classList.add('dragover');
                    });
                });

                ['dragleave', 'drop'].forEach(eventName => {
                    uploadArea.addEventListener(eventName, () => {
                        uploadArea.classList.remove('dragover');
                    });
                });

                uploadArea.addEventListener('drop', (e) => {
                    const files = e.dataTransfer.files;
                    if (files.length > 0) {
                        this.handleFileSelect(files[0]);
                    }
                });
            }

            async handleFileSelect(file) {
                console.log('handleFileSelect被调用，文件:', file);
                
                if (!file) {
                    console.log('文件为空，退出处理');
                    return;
                }

                console.log('文件信息:', {
                    name: file.name,
                    type: file.type,
                    size: file.size,
                    lastModified: file.lastModified
                });

                if (!file.type.startsWith('image/')) {
                    console.error('文件类型不是图片:', file.type);
                    this.showNotification('请选择图片文件（JPG、PNG、WEBP等）', 'error');
                    return;
                }

                if (file.size > 10 * 1024 * 1024) {
                    console.error('文件太大:', file.size);
                    this.showNotification('文件大小不能超过 10MB', 'error');
                    return;
                }

                try {
                    this.showNotification('正在处理图片...', 'info');
                    
                    // 压缩图片
                    const processedFile = await this.compressImage(file);
                    this.state.currentImage = processedFile;
                    
                    await this.displayImagePreview(processedFile);
                    this.updateDetectButton();
                    this.showNotification('图片上传成功', 'success');
                } catch (error) {
                    console.error('文件处理失败:', error);
                    this.showNotification('图片处理失败，请重试', 'error');
                }
            }

            async compressImage(file) {
                return new Promise((resolve, reject) => {
                    const img = new Image();
                    const canvas = document.createElement('canvas');
                    const ctx = canvas.getContext('2d');

                    img.onload = () => {
                        const maxSize = 2048;
                        let { width, height } = img;
                        
                        if (width > maxSize || height > maxSize) {
                            const ratio = Math.min(maxSize / width, maxSize / height);
                            width = Math.round(width * ratio);
                            height = Math.round(height * ratio);
                        }

                        canvas.width = width;
                        canvas.height = height;
                        ctx.drawImage(img, 0, 0, width, height);

                        canvas.toBlob(
                            (blob) => {
                                if (blob) {
                                    const compressedFile = new File([blob], file.name, {
                                        type: file.type,
                                        lastModified: Date.now()
                                    });
                                    resolve(compressedFile);
                                } else {
                                    reject(new Error('图片压缩失败'));
                                }
                            },
                            file.type,
                            0.8
                        );
                    };

                    img.onerror = () => reject(new Error('图片加载失败'));
                    img.src = URL.createObjectURL(file);
                });
            }

            async displayImagePreview(file) {
                return new Promise((resolve, reject) => {
                    const reader = new FileReader();
                    
                    reader.onload = (e) => {
                        if (this.elements.previewImg && this.elements.imagePreview) {
                            this.elements.previewImg.src = e.target.result;
                            this.elements.imagePreview.style.display = 'block';
                            this.elements.uploadArea.style.display = 'none';
                        }
                        resolve();
                    };
                    
                    reader.onerror = () => reject(new Error('图片预览失败'));
                    reader.readAsDataURL(file);
                });
            }

            removeImage() {
                this.state.currentImage = null;
                
                if (this.elements.imagePreview && this.elements.uploadArea) {
                    this.elements.imagePreview.style.display = 'none';
                    this.elements.uploadArea.style.display = 'block';
                }
                
                if (this.elements.imageInput) {
                    this.elements.imageInput.value = '';
                }
                
                this.updateDetectButton();
                this.showNotification('图片已移除', 'info');
            }

            updateDetectButton() {
                const hasImage = !!this.state.currentImage;
                const hasSelectedHazards = this.getSelectedHazards().length > 0;
                
                if (this.elements.detectBtn) {
                    this.elements.detectBtn.disabled = !(hasImage && hasSelectedHazards) || this.state.isDetecting;
                }
            }

            getSelectedHazards() {
                const checkboxes = document.querySelectorAll('.hazard-selection-item input[type="checkbox"]:checked');
                return Array.from(checkboxes).map(cb => parseInt(cb.value)).sort((a, b) => a - b);
            }

            getSelectedModel() {
                const modelRadio = document.querySelector('input[name="aiModel"]:checked');
                return modelRadio ? modelRadio.value : 'gemini-1.5-flash';
            }

            getFocusCategories() {
                const focusCheckboxes = document.querySelectorAll('.focus-category-item input[type="checkbox"]:checked');
                const focusCategories = [];
                focusCheckboxes.forEach(checkbox => {
                    const categories = checkbox.value.split(',').map(num => parseInt(num.trim()));
                    focusCategories.push(...categories);
                });
                return [...new Set(focusCategories)].sort((a, b) => a - b); // 去重并排序
            }

            selectAllHazards() {
                const checkboxes = document.querySelectorAll('.hazard-selection-item input[type="checkbox"]');
                checkboxes.forEach(checkbox => {
                    checkbox.checked = true;
                });
                this.showNotification('已选择所有隐患类别', 'success');
                this.updateDetectButton();
            }

            clearAllHazards() {
                const checkboxes = document.querySelectorAll('.hazard-selection-item input[type="checkbox"]');
                checkboxes.forEach(checkbox => {
                    checkbox.checked = false;
                });
                this.showNotification('已清空所有隐患类别选择', 'info');
                this.updateDetectButton();
            }

            async startDetection() {
                if (!this.state.currentImage) {
                    this.showNotification('请先上传图片', 'error');
                    return;
                }


                const selectedHazards = this.getSelectedHazards();
                if (selectedHazards.length === 0) {
                    this.showNotification('请至少选择一个隐患类别', 'error');
                    return;
                }

                this.state.isDetecting = true;
                this.setLoadingState(true);
                this.showResultsSection(false);

                try {
                    const imageBase64 = await this.fileToBase64(this.state.currentImage);
                    const customPrompt = this.elements.customPrompt?.value.trim() || '';
                    const focusCategories = this.getFocusCategories();
                    const detectionPrompt = this.buildDetectionPrompt(selectedHazards, customPrompt, focusCategories);
                    const selectedModel = this.getSelectedModel();

                    const result = await this.directClient.callAPI({
                        image: imageBase64,
                        prompt: detectionPrompt,
                        model: selectedModel,
                        config: {
                            temperature: 0.3, // 降低温度以提高准确性
                            maxOutputTokens: 3000 // 增加输出长度以支持详细分析
                        }
                    });

                    this.displayResults(result.result);
                    this.showResultsSection(true);
                    this.state.lastResults = result.result;

                    this.showNotification('检测完成', 'success');

                } catch (error) {
                    console.error('检测失败:', error);
                    this.showError(error.message);
                } finally {
                    this.state.isDetecting = false;
                    this.setLoadingState(false);
                }
            }

            async fileToBase64(file) {
                return new Promise((resolve, reject) => {
                    const reader = new FileReader();
                    reader.onload = () => resolve(reader.result);
                    reader.onerror = reject;
                    reader.readAsDataURL(file);
                });
            }

            buildDetectionPrompt(selectedHazards, customPrompt, focusCategories = []) {
                const hazardCategories = [
                    "1. 未按规定穿戴反光安全服",
                    "2. 高处作业未正确使用安全带", 
                    "3. 配电箱未及时锁闭",
                    "4. 未按规定配置灭火器、消防设施等",
                    "5. 现场防护栏等安全防护设施缺失、破损或设置不规范",
                    "6. 设备安全防护设施、装置缺失或失效",
                    "7. 起重吊装设备钢丝绳磨损、断丝严重，搭接长度不足",
                    "8. 汽车吊、随车吊、泵车支腿未全部伸出、未垫枕木进行作业",
                    "9. 基坑支护措施不到位",
                    "10. 灭火器未按规定要求放置",
                    "11. 未按规定设置接地线或接地不良",
                    "12. 安全警示标志标识缺失或设置不规范",
                    "13. 灭火器压力不足，灭火器、消防设施等未按规定进行检查、维护",
                    "14. 不符合"三级配电两级漏电保护、一机一闸一漏一箱"要求",
                    "15. 电缆外皮破损或敷设不规范"
                ];

                // 根据用户选择的隐患类别生成重点检测列表
                const selectedHazardsList = selectedHazards.map(num => hazardCategories[num - 1]).filter(Boolean);

                let prompt = `作为一个专业的工地隐患检查人员，你的任务是分析这张工地图片，重点检测以下用户选择的隐患类别：

【用户选择的重点检测类别】：
${selectedHazardsList.join('\n')}

【完整隐患类别参考】：
${hazardCategories.join('\n')}

${customPrompt ? `\n【特别关注事项】：\n${customPrompt}` : ''}

${focusCategories.length > 0 ? `\n【额外重点类别】：\n请同时关注以下编号的隐患类别：${focusCategories.join(', ')}` : ''}

请严格按照以下简洁格式输出分析结果：

## 输出

**隐患类别：**"[从15个标准类别中选择最匹配的隐患类别名称]"

**隐患描述：**"[简洁描述图片中观察到的具体违规行为或不安全状态，说明可能导致的安全风险]"

**整改意见：**"[提供具体的、可操作的整改措施和预防建议，包括立即措施和长期管理要求]"

要求：
1. 每个部分用一句话简洁表达，不要使用列表或分点
2. 隐患类别必须从15个标准类别中选择
3. 描述要具体、客观，直接说明风险
4. 整改意见要实用、可操作
5. 语言专业但易懂

注意：请基于图片内容进行客观分析，如果没有明显隐患，请如实说明。`;

                return prompt;
            }

            displayResults(result) {
                if (!this.elements.resultsContent) return;

                const formattedResult = this.formatResult(result);
                this.elements.resultsContent.innerHTML = formattedResult;

                if (this.elements.detectionTime) {
                    this.elements.detectionTime.textContent = `检测时间: ${new Date().toLocaleString('zh-CN')}`;
                }

                if (this.elements.imageInfo && this.state.currentImage) {
                    const sizeMB = (this.state.currentImage.size / 1024 / 1024).toFixed(2);
                    this.elements.imageInfo.textContent = `图片信息: ${this.state.currentImage.name} (${sizeMB}MB)`;
                }
            }

            formatResult(result) {
                let html = result
                    .replace(/## (.*)/g, '<h3 class="result-section-title">$1<\/h3>')
                    .replace(/### (.*)/g, '<h4 class="result-subsection-title">$1<\/h4>')
                    .replace(/^\- (.*)/gm, '<li class="result-list-item">$1<\/li>')
                    .replace(/^\* (.*)/gm, '<li class="result-list-item">$1<\/li>')
                    .replace(/^\d+\. (.*)/gm, '<li class="result-numbered-item">$1<\/li>')
                    .replace(/\*\*(.*?)\*\*/g, '<strong style="color: #e74c3c;">$1<\/strong>')
                    .replace(/\*(.*?)\*/g, '<em>$1<\/em>');

                // 特殊格式处理
                html = html.replace(/🚨/g, '<span style="color: #e74c3c; font-size: 1.2em;">🚨</span>');
                html = html.replace(/📊/g, '<span style="color: #3498db; font-size: 1.2em;">📊</span>');
                html = html.replace(/🔍/g, '<span style="color: #27ae60; font-size: 1.2em;">🔍</span>');
                
                // 风险等级着色
                html = html.replace(/高风险/g, '<span style="color: #e74c3c; font-weight: bold; background: rgba(231, 76, 60, 0.1); padding: 2px 6px; border-radius: 4px;">⚠️ 高风险</span>');
                html = html.replace(/中风险/g, '<span style="color: #f39c12; font-weight: bold; background: rgba(243, 156, 18, 0.1); padding: 2px 6px; border-radius: 4px;">⚡ 中风险</span>');
                html = html.replace(/低风险/g, '<span style="color: #27ae60; font-weight: bold; background: rgba(39, 174, 96, 0.1); padding: 2px 6px; border-radius: 4px;">✅ 低风险</span>');
                
                // 隐患编号高亮
                html = html.replace(/隐患编号(\d+)：/g, '<span style="background: linear-gradient(135deg, #ff6b6b, #ee5a24); color: white; padding: 3px 8px; border-radius: 6px; font-weight: bold; margin-right: 8px;">🔍 隐患编号$1</span>');
                html = html.replace(/(\d+)\.\s*([^：\n]+)/g, '<span style="background: linear-gradient(135deg, #4facfe, #00f2fe); color: white; padding: 2px 6px; border-radius: 4px; font-weight: bold; margin-right: 5px;">$1</span>$2');

                html = html.replace(/(<li class="result-list-item">.*<\/li>)/gs, '<ul class="result-list">$1<\/ul>');
                html = html.replace(/(<li class="result-numbered-item">.*<\/li>)/gs, '<ol class="result-numbered-list">$1<\/ol>');

                html = html.split('\n\n').map(paragraph => {
                    if (paragraph.trim() && !paragraph.includes('<h') && !paragraph.includes('<ul') && !paragraph.includes('<ol')) {
                        return `<p class="result-paragraph">${paragraph.trim()}<\/p>`;
                    }
                    return paragraph;
                }).join('\n');

                return html;
            }

            setLoadingState(loading) {
                if (!this.elements.detectBtn) return;

                const btnText = this.elements.detectBtn.querySelector('.btn-text');
                const btnLoading = this.elements.detectBtn.querySelector('.btn-loading');

                if (loading) {
                    this.elements.detectBtn.disabled = true;
                    if (btnText) btnText.style.display = 'none';
                    if (btnLoading) btnLoading.style.display = 'inline-block';
                } else {
                    this.elements.detectBtn.disabled = false;
                    if (btnText) btnText.style.display = 'inline';
                    if (btnLoading) btnLoading.style.display = 'none';
                }
            }

            showResultsSection(show) {
                if (this.elements.resultsSection) {
                    this.elements.resultsSection.style.display = show ? 'block' : 'none';
                    if (show) {
                        this.elements.resultsSection.scrollIntoView({ behavior: 'smooth' });
                    }
                }
            }

            showError(message) {
                if (!this.elements.resultsContent) return;

                this.elements.resultsContent.innerHTML = `
                    <div class="error-container">
                        <div class="error-icon">⚠️</div>
                        <div class="error-content">
                            <h3>检测失败</h3>
                            <p class="error-message">${message}</p>
                            <div class="error-solutions">
                                <h4>可能的解决方案：</h4>
                                <ul>
                                    <li>检查网络连接是否正常</li>
                                    <li>确认 API 密钥是否正确</li>
                                    <li>尝试重新上传图片</li>
                                    <li>联系技术支持</li>
                                </ul>
                            </div>
                            <button class="retry-btn" onclick="window.constructionDetector.startDetection()">
                                重试检测
                            </button>
                        </div>
                    </div>
                `;

                this.showResultsSection(true);
            }

            clearAll() {
                this.removeImage();
                
                if (this.elements.customPrompt) {
                    this.elements.customPrompt.value = '';
                }

                const checkboxes = document.querySelectorAll('.option-item input[type="checkbox"]');
                checkboxes.forEach(checkbox => {
                    checkbox.checked = true;
                });

                this.showResultsSection(false);
                this.state.lastResults = null;
                this.updateDetectButton();
                this.showNotification('已清空所有内容', 'success');
            }

            downloadReport() {
                if (!this.state.lastResults) {
                    this.showNotification('没有可下载的报告', 'error');
                    return;
                }

                const timestamp = new Date().toISOString().slice(0, 19).replace(/[:-]/g, '');
                const filename = `工地检测报告_${timestamp}.txt`;
                
                const content = `工地检测报告
生成时间: ${new Date().toLocaleString('zh-CN')}
图片信息: ${this.state.currentImage?.name || '未知'}

${this.state.lastResults}`;

                const blob = new Blob([content], { type: 'text/plain;charset=utf-8' });
                const url = URL.createObjectURL(blob);
                
                const a = document.createElement('a');
                a.href = url;
                a.download = filename;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);

                this.showNotification('报告已下载', 'success');
            }

            shareResults() {
                if (!this.state.lastResults) {
                    this.showNotification('没有可分享的结果', 'error');
                    return;
                }

                const shareData = {
                    title: '工地检测报告',
                    text: this.state.lastResults.substring(0, 200) + '...',
                    url: window.location.href
                };

                if (navigator.share && navigator.canShare(shareData)) {
                    navigator.share(shareData);
                } else if (navigator.clipboard) {
                    navigator.clipboard.writeText(this.state.lastResults).then(() => {
                        this.showNotification('检测结果已复制到剪贴板', 'success');
                    }).catch(() => {
                        this.showNotification('复制失败，请手动选择复制', 'error');
                    });
                } else {
                    this.showNotification('您的浏览器不支持分享功能', 'error');
                }
            }

            showNotification(message, type = 'info', duration = 3000) {
                const existingNotification = document.querySelector('.notification');
                if (existingNotification) {
                    existingNotification.remove();
                }

                const notification = document.createElement('div');
                notification.className = `notification notification-${type}`;
                
                notification.innerHTML = `
                    <div class="notification-content">
                        <span class="notification-icon">${this.getNotificationIcon(type)}</span>
                        <span class="notification-message">${message}</span>
                        <button class="notification-close">&times;</button>
                    </div>
                `;

                Object.assign(notification.style, {
                    position: 'fixed',
                    top: '20px',
                    right: '20px',
                    padding: '12px 16px',
                    borderRadius: '8px',
                    color: 'white',
                    fontWeight: '500',
                    zIndex: '10000',
                    opacity: '0',
                    transform: 'translateX(100%)',
                    transition: 'all 0.3s ease',
                    maxWidth: '400px',
                    boxShadow: '0 4px 12px rgba(0, 0, 0, 0.15)',
                    backgroundColor: this.getNotificationColor(type)
                });

                document.body.appendChild(notification);

                requestAnimationFrame(() => {
                    notification.style.opacity = '1';
                    notification.style.transform = 'translateX(0)';
                });

                notification.querySelector('.notification-close').addEventListener('click', () => {
                    this.hideNotification(notification);
                });

                if (duration > 0) {
                    setTimeout(() => {
                        if (document.body.contains(notification)) {
                            this.hideNotification(notification);
                        }
                    }, duration);
                }
            }

            hideNotification(notification) {
                notification.style.opacity = '0';
                notification.style.transform = 'translateX(100%)';
                setTimeout(() => {
                    if (document.body.contains(notification)) {
                        document.body.removeChild(notification);
                    }
                }, 300);
            }

            getNotificationIcon(type) {
                const icons = {
                    success: '✅',
                    error: '❌',
                    warning: '⚠️',
                    info: 'ℹ️'
                };
                return icons[type] || icons.info;
            }

            getNotificationColor(type) {
                const colors = {
                    success: '#52c41a',
                    error: '#ff4d4f', 
                    warning: '#faad14',
                    info: '#1890ff'
                };
                return colors[type] || colors.info;
            }

            loadUserPreferences() {
                try {
                    const saved = localStorage.getItem('construction-detection-preferences');
                    if (saved) {
                        const preferences = JSON.parse(saved);
                        
                        if (preferences.detectionOptions) {
                            Object.entries(preferences.detectionOptions).forEach(([key, checked]) => {
                                const checkbox = document.querySelector(`input[value="${key}"]`);
                                if (checkbox) {
                                    checkbox.checked = checked;
                                }
                            });
                        }

                        if (preferences.customPrompt && this.elements.customPrompt) {
                            this.elements.customPrompt.value = preferences.customPrompt;
                        }
                    }
                } catch (error) {
                    console.warn('加载用户偏好失败:', error);
                }
            }

            saveUserPreferences() {
                try {
                    const preferences = {
                        detectionOptions: {},
                        customPrompt: this.elements.customPrompt?.value || '',
                        lastSaved: new Date().toISOString()
                    };

                    const checkboxes = document.querySelectorAll('.option-item input[type="checkbox"]');
                    checkboxes.forEach(checkbox => {
                        preferences.detectionOptions[checkbox.value] = checkbox.checked;
                    });

                    localStorage.setItem('construction-detection-preferences', JSON.stringify(preferences));
                } catch (error) {
                    console.warn('保存用户偏好失败:', error);
                }
            }
        }

        // 初始化应用
        document.addEventListener('DOMContentLoaded', () => {
            window.constructionDetector = new ConstructionDetectionSimple();
        });
    </script>
<!-- hexo injector body_end start -->
  <script data-pjax="" src="/js/hexo_githubcalendar.js?v=20250920"></script>
  <script data-pjax="">
        function GithubCalendarConfig(){
            var git_githubapiurl ="https://github-calendar-api.meta-code.top/api?user=wp-a";
            var git_color =['#ebedf0', '#a2f7af', '#6ce480', '#54ad63', '#469252', '#31753c', '#1f5f2a', '#13531f', '#084111', '#032b09', '#000000'];
            var git_user ="wp-a";
            var parent_div_git = document.getElementById('recent-posts');
            var git_div_html = '<div class="recent-post-item" style="width:100%;height:auto;padding:10px;"><div id="github_loading" style="width:10%;height:100%;margin:0 auto;display: block"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"  viewBox="0 0 50 50" style="enable-background:new 0 0 50 50" xml:space="preserve"><path fill="#d0d0d0" d="M25.251,6.461c-10.318,0-18.683,8.365-18.683,18.683h4.068c0-8.071,6.543-14.615,14.615-14.615V6.461z" transform="rotate(275.098 25 25)"><animateTransform attributeType="xml" attributeName="transform" type="rotate" from="0 25 25" to="360 25 25" dur="0.6s" repeatCount="indefinite"></animateTransform></path></svg></div><div id="github_container"></div></div>';
            if(parent_div_git && location.pathname =='/'){
                console.log("已挂载hexo-github-calendar https://github.com/Barry-Flynn/hexo-github-calendar");
                // parent_div_git.innerHTML=git_div_html+parent_div_git.innerHTML // 无报错，但不影响使用(支持pjax跳转)
                parent_div_git.insertAdjacentHTML("afterbegin",git_div_html) // 有报错，但不影响使用(支持pjax跳转)
            };
            GithubCalendar(git_githubapiurl,git_color,git_user)
        }
        if(document.getElementById('recent-posts')){
            GithubCalendarConfig()
        }
    </script>
    <style>#github_container{min-height:280px}@media screen and (max-width:650px) {#github_container{background-image:;min-height:0px}}</style>
    <style></style><!-- hexo injector body_end end -->

</div><hr class="custom-hr"><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div class="vcomment" id="vcomment"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="https://wpironman.oss-cn-qingdao.aliyuncs.com/head.png" onerror="this.onerror=null;this.src='https://wpironman.oss-cn-qingdao.aliyuncs.com/head.gif'" alt="avatar" loading="lazy"></div><div class="author-info-name">WP</div><div class="author-info-description">无业游民</div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">29</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">59</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">14</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/wp-a"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/wp-a" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="mailto:2829624376@qq.com" target="_blank" title="Email"><i class="fas fa-envelope" style="color: #4a7dbe;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content is-expand"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">1.</span> <span class="toc-text">🏗️ 工地检测助手</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link"><span class="toc-number">1.1.</span> <span class="toc-text">📸 上传检测图片</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link"><span class="toc-number">1.1.1.</span> <span class="toc-text">📋 专业隐患类别参考</span></a></li><li class="toc-item toc-level-3"><a class="toc-link"><span class="toc-number">1.1.2.</span> <span class="toc-text">🤖 选择AI模型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link"><span class="toc-number">1.1.3.</span> <span class="toc-text">🎯 重点检测隐患类别（可选）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link"><span class="toc-number">1.1.4.</span> <span class="toc-text">🎯 选择要检测的隐患类别</span></a></li><li class="toc-item toc-level-3"><a class="toc-link"><span class="toc-number">1.1.5.</span> <span class="toc-text">✏️ 自定义检测要求</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#resultsSection"><span class="toc-number">1.1.6.</span> <span class="toc-text">检测结果</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2025/09/MambaOut/" title="MambaOut"><img src="https://wpironman.oss-cn-qingdao.aliyuncs.com/202509111759034.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="MambaOut" loading="lazy"></a><div class="content"><a class="title" href="/2025/09/MambaOut/" title="MambaOut">MambaOut</a><time datetime="2025-09-10T22:00:53.000Z" title="发表于 2025-09-10 22:00:53">2025-09-10</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/09/%E5%9B%BE%E5%8D%B7%E7%A7%AF%E7%BD%91%E7%BB%9C/" title="图神经网络"><img src="https://wpironman.oss-cn-qingdao.aliyuncs.com/202509071900984.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="图神经网络" loading="lazy"></a><div class="content"><a class="title" href="/2025/09/%E5%9B%BE%E5%8D%B7%E7%A7%AF%E7%BD%91%E7%BB%9C/" title="图神经网络">图神经网络</a><time datetime="2025-09-07T09:28:09.000Z" title="发表于 2025-09-07 09:28:09">2025-09-07</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/06/%E6%89%8B%E6%92%95%20Vision%20Transformer/" title="手撕 Vision Transformer"><img src="https://wpironman.oss-cn-qingdao.aliyuncs.com/20250601121856303.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="手撕 Vision Transformer" loading="lazy"></a><div class="content"><a class="title" href="/2025/06/%E6%89%8B%E6%92%95%20Vision%20Transformer/" title="手撕 Vision Transformer">手撕 Vision Transformer</a><time datetime="2025-06-01T12:09:13.000Z" title="发表于 2025-06-01 12:09:13">2025-06-01</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/04/MOE/" title="MoE"><img src="https://wpironman.oss-cn-qingdao.aliyuncs.com/20250502161913940.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="MoE" loading="lazy"></a><div class="content"><a class="title" href="/2025/04/MOE/" title="MoE">MoE</a><time datetime="2025-04-27T20:37:24.000Z" title="发表于 2025-04-27 20:37:24">2025-04-27</time></div></div></div></div><div class="card-widget card-categories"><div class="item-headline">
            <i class="fas fa-folder-open"></i>
            <span>分类</span>
            <a class="card-more-btn" href="/categories/" title="查看更多">
      <i class="fas fa-angle-right"></i></a>
          </div>
          <ul class="card-category-list" id="aside-cat-list">
            <li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E6%89%8B%E6%92%95%E4%BB%A3%E7%A0%81/"><span class="card-category-list-name">手撕代码</span><span class="card-category-list-count">1</span></a><ul class="card-category-list child"><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E6%89%8B%E6%92%95%E4%BB%A3%E7%A0%81/Vision-Transformer/"><span class="card-category-list-name">Vision Transformer</span><span class="card-category-list-count">1</span></a></li></ul></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/"><span class="card-category-list-name">数据结构与算法</span><span class="card-category-list-count">21</span></a><ul class="card-category-list child"><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/%E4%BB%A3%E7%A0%81%E9%9A%8F%E6%83%B3%E5%BD%95/"><span class="card-category-list-name">代码随想录</span><span class="card-category-list-count">14</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/"><span class="card-category-list-name">基础知识</span><span class="card-category-list-count">7</span></a></li></ul></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/"><span class="card-category-list-name">深度学习</span><span class="card-category-list-count">1</span></a><ul class="card-category-list child"><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/%E5%9B%BE%E5%83%8F%E5%88%86%E7%B1%BB/"><span class="card-category-list-name">图像分类</span><span class="card-category-list-count">1</span></a></li></ul></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E8%AE%BA%E6%96%87%E7%B2%BE%E8%AF%BB/"><span class="card-category-list-name">论文精读</span><span class="card-category-list-count">6</span></a></li>
          </ul></div><div class="card-widget card-tags"><div class="item-headline"><i class="fas fa-tags"></i><span>标签</span></div><div class="card-tag-cloud"><a href="/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/" style="font-size: 1.45em; color: rgb(50, 149, 98);">数据结构与算法</a><a href="/tags/%E4%BA%8C%E5%8F%89%E6%A0%91/" style="font-size: 1.25em; color: rgb(84, 89, 181);">二叉树</a><a href="/tags/%E4%BA%8C%E5%8F%89%E6%A0%91%E9%81%8D%E5%8E%86/" style="font-size: 1.25em; color: rgb(166, 50, 137);">二叉树遍历</a><a href="/tags/%E9%80%92%E5%BD%92/" style="font-size: 1.4em; color: rgb(54, 50, 159);">递归</a><a href="/tags/%E8%BF%AD%E4%BB%A3/" style="font-size: 1.25em; color: rgb(130, 169, 159);">迭代</a><a href="/tags/%E5%9B%9E%E6%BA%AF/" style="font-size: 1.2em; color: rgb(119, 127, 78);">回溯</a><a href="/tags/%E5%89%AA%E6%9E%9D/" style="font-size: 1.15em; color: rgb(89, 94, 50);">剪枝</a><a href="/tags/%E5%9B%BE%E8%AE%BA/" style="font-size: 1.2em; color: rgb(95, 71, 50);">图论</a><a href="/tags/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/" style="font-size: 1.15em; color: rgb(85, 83, 161);">动态规划</a><a href="/tags/%E4%BA%8C%E5%88%86%E6%9F%A5%E6%89%BE/" style="font-size: 1.15em; color: rgb(142, 100, 96);">二分查找</a><a href="/tags/%E5%8F%8C%E6%8C%87%E9%92%88/" style="font-size: 1.35em; color: rgb(185, 174, 90);">双指针</a><a href="/tags/%E6%95%B0%E7%BB%84/" style="font-size: 1.25em; color: rgb(195, 93, 50);">数组</a><a href="/tags/%E6%BB%91%E5%8A%A8%E7%AA%97%E5%8F%A3/" style="font-size: 1.15em; color: rgb(134, 57, 50);">滑动窗口</a><a href="/tags/%E7%9F%A9%E9%98%B5%E8%A7%84%E5%BE%8B/" style="font-size: 1.15em; color: rgb(67, 50, 195);">矩阵规律</a><a href="/tags/%E5%89%8D%E7%BC%80%E5%92%8C/" style="font-size: 1.15em; color: rgb(50, 88, 50);">前缀和</a><a href="/tags/%E9%93%BE%E8%A1%A8/" style="font-size: 1.3em; color: rgb(185, 81, 185);">链表</a><a href="/tags/%E5%93%88%E5%B8%8C%E8%A1%A8/" style="font-size: 1.25em; color: rgb(116, 119, 74);">哈希表</a><a href="/tags/%E6%9F%A5%E6%89%BE/" style="font-size: 1.2em; color: rgb(50, 57, 77);">查找</a><a href="/tags/set/" style="font-size: 1.2em; color: rgb(128, 50, 50);">set</a><a href="/tags/map/" style="font-size: 1.25em; color: rgb(131, 50, 50);">map</a><a href="/tags/%E5%AD%97%E7%AC%A6%E4%B8%B2/" style="font-size: 1.15em; color: rgb(63, 55, 81);">字符串</a><a href="/tags/KMP/" style="font-size: 1.15em; color: rgb(128, 88, 197);">KMP</a><a href="/tags/reverse/" style="font-size: 1.15em; color: rgb(65, 53, 194);">reverse</a><a href="/tags/%E6%A0%88/" style="font-size: 1.15em; color: rgb(187, 50, 174);">栈</a><a href="/tags/%E9%98%9F%E5%88%97/" style="font-size: 1.15em; color: rgb(50, 124, 50);">队列</a><a href="/tags/%E5%8F%8C%E7%AB%AF%E9%98%9F%E5%88%97/" style="font-size: 1.15em; color: rgb(173, 50, 94);">双端队列</a><a href="/tags/%E5%A0%86/" style="font-size: 1.15em; color: rgb(115, 96, 69);">堆</a><a href="/tags/queue/" style="font-size: 1.2em; color: rgb(110, 165, 50);">queue</a><a href="/tags/stack/" style="font-size: 1.2em; color: rgb(199, 127, 50);">stack</a><a href="/tags/deque/" style="font-size: 1.2em; color: rgb(122, 150, 133);">deque</a><a href="/tags/%E8%A7%86%E8%A7%89%E8%A1%A8%E5%BE%81/" style="font-size: 1.15em; color: rgb(50, 90, 77);">视觉表征</a><a href="/tags/%E8%AE%BA%E6%96%87%E7%B2%BE%E8%AF%BB/" style="font-size: 1.4em; color: rgb(103, 50, 116);">论文精读</a><a href="/tags/%E6%B7%B7%E5%90%88%E4%B8%93%E5%AE%B6%E7%B3%BB%E7%BB%9F/" style="font-size: 1.15em; color: rgb(149, 94, 181);">混合专家系统</a><a href="/tags/Mamba/" style="font-size: 1.15em; color: rgb(50, 150, 172);">Mamba</a><a href="/tags/%E5%AF%B9%E6%AF%94%E5%AD%A6%E4%B9%A0/" style="font-size: 1.15em; color: rgb(50, 50, 50);">对比学习</a><a href="/tags/STL/" style="font-size: 1.15em; color: rgb(185, 50, 161);">STL</a><a href="/tags/vector/" style="font-size: 1.15em; color: rgb(50, 50, 50);">vector</a><a href="/tags/string/" style="font-size: 1.15em; color: rgb(79, 198, 174);">string</a><a href="/tags/algorithm/" style="font-size: 1.15em; color: rgb(150, 119, 69);">algorithm</a><a href="/tags/priority-queue/" style="font-size: 1.15em; color: rgb(197, 125, 50);">priority_queue</a></div></div><div class="card-widget card-archives">
    <div class="item-headline">
      <i class="fas fa-archive"></i>
      <span>归档</span>
      
    </div>
  
    <ul class="card-archive-list">
      
        <li class="card-archive-list-item">
          <a class="card-archive-list-link" href="/archives/2025/09/">
            <span class="card-archive-list-date">
              九月 2025
            </span>
            <span class="card-archive-list-count">2</span>
          </a>
        </li>
      
        <li class="card-archive-list-item">
          <a class="card-archive-list-link" href="/archives/2025/06/">
            <span class="card-archive-list-date">
              六月 2025
            </span>
            <span class="card-archive-list-count">1</span>
          </a>
        </li>
      
        <li class="card-archive-list-item">
          <a class="card-archive-list-link" href="/archives/2025/04/">
            <span class="card-archive-list-date">
              四月 2025
            </span>
            <span class="card-archive-list-count">5</span>
          </a>
        </li>
      
        <li class="card-archive-list-item">
          <a class="card-archive-list-link" href="/archives/2025/03/">
            <span class="card-archive-list-date">
              三月 2025
            </span>
            <span class="card-archive-list-count">6</span>
          </a>
        </li>
      
        <li class="card-archive-list-item">
          <a class="card-archive-list-link" href="/archives/2025/02/">
            <span class="card-archive-list-date">
              二月 2025
            </span>
            <span class="card-archive-list-count">11</span>
          </a>
        </li>
      
        <li class="card-archive-list-item">
          <a class="card-archive-list-link" href="/archives/2025/01/">
            <span class="card-archive-list-date">
              一月 2025
            </span>
            <span class="card-archive-list-count">4</span>
          </a>
        </li>
      
    </ul>
  </div><div class="card-widget card-webinfo"><div class="item-headline"><i class="fas fa-chart-line"></i><span>网站信息</span></div><div class="webinfo"><div class="webinfo-item"><div class="item-name">文章数目 :</div><div class="item-count">29</div></div><div class="webinfo-item"><div class="item-name">运行时间 :</div><div class="item-count" id="runtimeshow" data-publishdate="2025-01-22T22:00:00.000Z"><i class="fa-solid fa-spinner fa-spin"></i></div></div><div class="webinfo-item"><div class="item-name">本站总字数 :</div><div class="item-count">51.7k</div></div><div class="webinfo-item"><div class="item-name">最后更新时间 :</div><div class="item-count" id="last-push-date" data-lastpushdate="2025-09-22T07:04:07.851Z"><i class="fa-solid fa-spinner fa-spin"></i></div></div><div class="webinfo-item"><div class="item-name">总访问量：</div><div class="item-count"><span id="my-pv">加载中...</span></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">©2025 By WP</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text"><div id="runtime"></div></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="前往评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js" defer=""></script><script src="/js/main.js" defer=""></script><script src="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/instant.page/5.1.0/instantpage.min.js" type="module"></script><div class="js-pjax"><script>(() => {
  const loadMathjax = () => {
    if (!window.MathJax) {
      window.MathJax = {
        tex: {
          inlineMath: [['$', '$'], ['\\(', '\\)']],
          tags: 'none',
        },
        chtml: {
          scale: 1.1
        },
        options: {
          enableMenu: true,
          renderActions: {
            findScript: [10, doc => {
              for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
                const display = !!node.type.match(/; *mode=display/)
                const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
                const text = document.createTextNode('')
                node.parentNode.replaceChild(text, node)
                math.start = {node: text, delim: '', n: 0}
                math.end = {node: text, delim: '', n: 0}
                doc.math.push(math)
              }
            }, '']
          }
        }
      }

      const script = document.createElement('script')
      script.src = 'https://cdn.jsdelivr.net/npm/mathjax/es5/tex-mml-chtml.min.js'
      script.id = 'MathJax-script'
      script.async = true
      document.head.appendChild(script)
    } else {
      MathJax.startup.document.state(0)
      MathJax.texReset()
      MathJax.typesetPromise()
    }
  }

  btf.addGlobalFn('encrypt', loadMathjax, 'mathjax')
  window.pjax ? loadMathjax() : window.addEventListener('load', loadMathjax)
})()</script><script>(() => {
  const runMermaid = ele => {
    window.loadMermaid = true
    const theme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'dark' : 'default'

    ele.forEach((item, index) => {
      const mermaidSrc = item.firstElementChild
      const mermaidThemeConfig = `%%{init:{ 'theme':'${theme}'}}%%\n`
      const mermaidID = `mermaid-${index}`
      const mermaidDefinition = mermaidThemeConfig + mermaidSrc.textContent

      const renderFn = mermaid.render(mermaidID, mermaidDefinition)
      const renderMermaid = svg => {
        mermaidSrc.insertAdjacentHTML('afterend', svg)
      }

      // mermaid v9 and v10 compatibility
      typeof renderFn === 'string' ? renderMermaid(renderFn) : renderFn.then(({ svg }) => renderMermaid(svg))
    })
  }

  const codeToMermaid = () => {
    const codeMermaidEle = document.querySelectorAll('pre > code.mermaid')
    if (codeMermaidEle.length === 0) return

    codeMermaidEle.forEach(ele => {
      const preEle = document.createElement('pre')
      preEle.className = 'mermaid-src'
      preEle.hidden = true
      preEle.textContent = ele.textContent
      const newEle = document.createElement('div')
      newEle.className = 'mermaid-wrap'
      newEle.appendChild(preEle)
      ele.parentNode.replaceWith(newEle)
    })
  }

  const loadMermaid = () => {
    if (true) codeToMermaid()
    const $mermaid = document.querySelectorAll('#article-container .mermaid-wrap')
    if ($mermaid.length === 0) return

    const runMermaidFn = () => runMermaid($mermaid)
    btf.addGlobalFn('themeChange', runMermaidFn, 'mermaid')
    window.loadMermaid ? runMermaidFn() : btf.getScript('https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js').then(runMermaidFn)
  }

  btf.addGlobalFn('encrypt', loadMermaid, 'mermaid')
  window.pjax ? loadMermaid() : document.addEventListener('DOMContentLoaded', loadMermaid)
})()</script><script>(() => {
  const isShuoshuo = GLOBAL_CONFIG_SITE.pageType === 'shuoshuo'
  const option = null

  const initValine = (el, path) => {
    if (isShuoshuo) {
      window.shuoshuoComment.destroyValine = () => {
        if (el.children.length) {
          el.innerHTML = ''
          el.classList.add('no-comment')
        }
      }
    }

    const valineConfig = {
      el: '#vcomment',
      appId: 'B3GpDA8AVyqx7H7uFClhxmMn-MdYXbMMI',
      appKey: 'nNNXxEpK6ldH3OkcySiOdNAo',
      avatar: 'monsterid',
      serverURLs: 'https://b3gpda8a.api.lncldglobal.com',
      emojiMaps: "",
      visitor: false,
      ...option,
      path: isShuoshuo ? path : (option && option.path) || window.location.pathname
    }

    new Valine(valineConfig)
  }

  const loadValine = async (el, path) => {
    if (typeof Valine === 'function') {
      initValine(el, path)
    } else {
      await btf.getScript('https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/valine/1.4.16/Valine.min.js')
      initValine(el, path)
    }
  }

  if (isShuoshuo) {
    'Valine' === 'Valine'
      ? window.shuoshuoComment = { loadComment: loadValine }
      : window.loadOtherComment = loadValine
    return
  }

  if ('Valine' === 'Valine' || !false) {
    if (false) btf.loadComment(document.getElementById('vcomment'),loadValine)
    else setTimeout(loadValine, 0)
  } else {
    window.loadOtherComment = loadValine
  }
})()</script></div><script type="text/javascript" src="/js/reward.js" defer=""></script><script async="" src="https://cdn.bootcss.com/jquery/3.4.1/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/echarts@5.4.1/dist/echarts.min.js"></script><script data-pjax="" src="/js/hexo_githubcalendar.js?v=20250920"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = true;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><script src="https://lib.baomitu.com/pjax/0.2.8/pjax.min.js" defer="defer"></script><script>(() => {
  const pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]

  window.pjax = new Pjax({
    elements: 'a:not([target="_blank"]):not([href="/music/"]):not([href="/gallery/"]):not([href="/about/"])',
    selectors: pjaxSelectors,
    cacheBust: false,
    analytics: false,
    scrollRestoration: false
  })

  const triggerPjaxFn = (val) => {
    if (!val) return
    Object.values(val).forEach(fn => fn())
  }

  document.addEventListener('pjax:send', () => {
    // removeEventListener
    btf.removeGlobalFnEvent('pjaxSendOnce')
    btf.removeGlobalFnEvent('themeChange')

    // reset readmode
    const $bodyClassList = document.body.classList
    if ($bodyClassList.contains('read-mode')) $bodyClassList.remove('read-mode')

    triggerPjaxFn(window.globalFn.pjaxSend)
  })

  document.addEventListener('pjax:complete', () => {
    btf.removeGlobalFnEvent('pjaxCompleteOnce')
    document.querySelectorAll('script[data-pjax]').forEach(item => {
      const newScript = document.createElement('script')
      const content = item.text || item.textContent || item.innerHTML || ""
      Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
      newScript.appendChild(document.createTextNode(content))
      item.parentNode.replaceChild(newScript, item)
    })

    triggerPjaxFn(window.globalFn.pjaxComplete)
  })

  document.addEventListener('pjax:error', e => {
    if (e.request.status === 404) {
      pjax.loadUrl('/404.html')
    }
  })
})()</script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="text-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"></div></div><hr><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js" defer="defer"></script></div></div></body></html>